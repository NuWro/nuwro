#ifndef _niwg_tech_h_
#define _niwg_tech_h_

const string par  = "-p 'number_of_test_events = 5000000' -p 'number_of_events = 100000' -p 'dyn_qel_cc = 1' -p 'dyn_qel_nc = 1' -p 'dyn_res_cc = 1' -p 'dyn_res_nc = 1' -p 'dyn_dis_cc = 1' -p 'dyn_dis_nc = 1' -p 'dyn_coh_cc = 1' -p 'dyn_coh_nc = 1' ";
const string par_stat  = "-p 'number_of_test_events = 5000000' -p 'number_of_events = 1000000' -p 'dyn_qel_cc = 1' -p 'dyn_qel_nc = 1' -p 'dyn_res_cc = 1' -p 'dyn_res_nc = 1' -p 'dyn_dis_cc = 1' -p 'dyn_dis_nc = 1' -p 'dyn_coh_cc = 1' -p 'dyn_coh_nc = 1' ";

const string nuflux[4] = {
"-p 'beam_type = 0' -p 'beam_particle = 14' -p 'beam_energy = 50 9450 38571.4 82467.5 134286 208016 291786 389464 496786 601825 747946 945238 1.09036e+06 1.13119e+06 1.07349e+06 915000 676786 455000 293571 194048 141464 110714 91904.8 78285.7 68015.9 60918.4 53954.1 48452.4 43035.7 39365.1 35754 33992.3 32251.3 30510.2 28769.1 27028.1 25287 24085.1 22989.6 21894.1 20798.6 19703 18607.5 17512 16416.5 15321 14266.5 13917.1 13567.6 13218.1 12868.7 12519.2 12169.7 11820.3 11470.8 11121.4 10771.9 10507.9 10260.8 10013.6 9766.52 9519.39 9272.26 9025.14 8778.01 8530.88 8308.78 8206.78 8104.78 8002.77 7900.77 7798.77 7696.77 7594.77 7492.77 7390.76 7288.76 7196.35 7105.94 7015.53 6925.12 6834.71 6744.3 6653.89 6563.47 6473.06 6382.65 6245.64 6098.92 5952.2 5805.48 5658.75 5512.03 5365.31 5218.59 5071.87 4925.15 4787.18 4651.05 4514.91 4378.77 4242.63 4106.49 3970.35 3834.22 3698.08 3561.94 3425.8 3289.66 3153.53 3017.39 2881.25 2767.77 2704.64 2641.51 2578.38 2515.25 2452.12 2389 2325.87 2262.74 2199.61 2136.48 2073.35 2010.22 1947.09 1883.97 1820.84 1757.71 1694.58 1631.45 1568.32 1524.02 1489.62 1455.22 1420.82 1386.42 1352.02 1317.63 1283.23 1248.83 1214.43 1180.03 1145.63 1111.24 1076.84 1042.44 1008.04 973.643 939.245 904.847 870.448 847.568 830.749 813.93 797.111 780.292 763.473 746.654 729.835 713.016 696.197 679.377 662.558 645.739 628.92 612.101 595.282 578.463 561.644 544.825 528.006 514.286 502.196 490.106 478.017 465.927 453.837 441.748 429.658 417.568 405.478 393.389 381.299 369.209 357.12 345.03 332.94 320.85 308.761 296.671' ",
"-p 'beam_type = 0' -p 'beam_particle =-14' -p 'beam_energy = 50 9450 30264.9 34305.2 34028.6 30703.8 26975.1 27044.5 27369.6 27746.9 28126.5 27779.2 27413.1 26882.3 26331.1 24512 22578 20644.1 18710.1 17191.8 15675.9 14695.9 13768.4 12933.3 12098.2 11433.4 10770.2 9830.67 8891.1 8107.64 7336.35 6880.7 6439.43 6213.76 5990.46 5520.28 5050.11 4809.09 4587.31 4365.54 4143.76 3868.78 3592.18 3381.59 3171.36 2938.91 2705.28 2495.05 2284.81 2307.97 2341.74 2375.5 2270.61 2164.19 2057.77 1951.34 1840.22 1728.04 1615.85 1503.66 1491 1494.39 1497.78 1482.94 1388.2 1293.45 1198.71 1138.77 1134.57 1130.36 1126.16 1108.57 1048.01 987.446 926.886 869.666 845.929 822.193 798.457 774.72 749.48 724.151 698.822 673.492 648.163 622.833 597.859 583.501 569.143 554.785 540.427 526.068 511.71 497.352 482.994 468.636 454.31 443.006 431.702 420.398 409.093 397.789 386.485 375.181 363.877 352.572 341.268 329.964 318.66 307.355 296.051 285.453 278.819 272.185 265.551 258.917 252.283 245.648 239.014 232.38 225.746 219.112 212.478 205.844 199.21 192.575 185.941 179.307 172.673 166.039 159.405 152.771 147.274 143.367 139.46 135.554 131.647 127.741 123.834 119.928 116.021 112.114 108.208 104.301 100.395 96.4881 92.5816 88.675 84.7684 80.8618 76.9553 73.0487 70.0752 68.666 67.2567 65.8475 64.4382 63.029 61.6197 60.2105 58.8012 57.392 55.9827 54.5735 53.1642 51.755 50.3457 48.9365 47.5272 46.118 44.7087 43.2995 42.5277 42.0615 41.5953 41.129 40.6628 40.1966 39.7303 39.2641 38.7979 38.3316 37.8654 37.3991 36.9329 36.4667 36.0004 35.5342 35.068 34.6017 34.1355' ",
"-p 'beam_type = 0' -p 'beam_particle = 12' -p 'beam_energy = 50 9450 682.68 1614.26 2547.81 3539.18 4497.06 4879.09 5261.12 5389.59 5493.08 5447.68 5400.58 5199.56 4992.35 4603.48 4214.62 3951.77 3690.69 3362.89 3035.08 2856.57 2678.66 2405.14 2135.59 1982.91 1833.19 1734.37 1635.54 1523.59 1411.2 1357.52 1304.49 1222.73 1139.13 1093.73 1048.33 1030.99 1015.27 983.975 952.147 928.287 904.697 897.463 890.229 866.417 841.434 820.08 798.725 782.205 766.49 750.775 731.959 712.76 693.561 674.362 651.394 627.623 603.851 580.08 558.781 537.857 516.933 496.01 477.714 460.207 442.699 425.192 409.079 393.749 378.419 363.089 352.524 342.774 333.024 323.273 310.985 297.728 284.472 271.215 259.332 251.523 243.713 235.904 228.094 220.285 212.476 204.683 197.583 190.483 183.383 176.282 169.182 162.082 154.982 147.882 140.782 135.001 131.267 127.533 123.799 120.065 116.331 112.597 108.863 105.129 101.396 97.6616 93.9277 90.1938 86.4599 82.7259 79.3897 77.2714 75.1531 73.0348 70.9164 68.7981 66.6798 64.5615 62.4431 60.3248 58.2065 56.0882 53.9698 51.8515 49.7332 47.6149 45.4965 43.3782 41.2599 39.1416 37.3594 36.4119 35.4644 34.5169 33.5694 32.6219 31.6744 30.7269 29.7794 28.8319 27.8844 26.9369 25.9894 25.042 24.0945 23.147 22.1995 21.252 20.3045 19.357 18.4095 17.8893 17.38 16.8706 16.3612 15.8519 15.3425 14.8332 14.3238 13.8145 13.3051 12.7958 12.2864 11.7771 11.2677 10.7583 10.249 9.73964 9.23028 8.72093 8.34094 8.18991 8.03887 7.88783 7.73679 7.58575 7.43471 7.28368 7.13264 6.9816 6.83056 6.67952 6.52848 6.37745 6.22641 6.07537 5.92433 5.77329 5.62226' ",
"-p 'beam_type = 0' -p 'beam_particle =-12' -p 'beam_energy = 50 9450 69.169 148.438 227.629 291.149 353.265 382.617 411.969 463.842 510.51 499.004 487.645 486.89 486.136 481.116 475.782 511.634 539.866 479.616 419.964 403.28 387.281 387.244 385.393 358.873 333.381 317.574 302.12 312.118 322.116 311.572 299.771 291.411 283.23 276.741 270.206 260.333 250.926 252.401 252.375 231.908 213.194 211.007 208.89 211.879 214.122 198.952 184.749 183.703 182.657 181.116 175.558 169.999 164.44 159.004 155.67 152.336 149.002 145.669 142.772 139.884 136.996 134.108 130.574 126.825 123.076 119.326 113.526 107.593 101.661 95.7284 94.1626 93.803 93.4434 93.0838 90.1456 87.1387 84.1318 81.1249 78.5051 76.3185 74.1319 71.9453 69.7588 67.5722 65.3856 63.899 62.4974 61.0958 59.6942 58.2926 56.891 55.4894 54.0878 52.6862 51.2846 49.8847 48.4864 47.0881 45.6899 44.2916 42.8933 41.4951 40.0968 38.6985 37.3003 35.902 34.5037 33.1055 31.7072 30.3089 29.547 28.8139 28.0808 27.3477 26.6146 25.8816 25.1485 24.4154 23.6823 22.9492 22.2161 21.483 20.7499 20.0168 19.2837 18.5506 17.8175 17.0844 16.3513 15.6873 15.2732 14.8591 14.445 14.031 13.6169 13.2028 12.7887 12.3747 11.9606 11.5465 11.1324 10.7184 10.3043 9.89021 9.47614 9.06206 8.64799 8.23391 7.81984 7.40576 7.17193 6.98789 6.80385 6.61981 6.43577 6.25173 6.06769 5.88365 5.69961 5.51557 5.33153 5.14749 4.96345 4.77941 4.59537 4.41133 4.22728 4.04324 3.8592 3.68106 3.63326 3.58546 3.53767 3.48987 3.44207 3.39427 3.34647 3.29868 3.25088 3.20308 3.15528 3.10748 3.05968 3.01189 2.96409 2.91629 2.86849 2.82069 2.77289' "};

const string oxygen_fg = "-p 'nucleus_p = 8' -p 'nucleus_n = 8' -p 'nucleus_target = 1' -p 'FSI_on = 1' -p 'pauli_blocking = 1' -p 'sf_method = 0' ";
const string oxygen_sf = "-p 'nucleus_p = 8' -p 'nucleus_n = 8' -p 'nucleus_target = 4' -p 'FSI_on = 1' -p 'pauli_blocking = 1' -p 'sf_method = 1' ";

const string nuname[4] = {"numu", "numubar", "nue", "nuebar"};
const double nupart[4]  = {0.928, 0.059, 0.011, 0.002};
const double nufield[4] = {1.17936e7, 753859, 136727, 21910.9};

const double nofH = 150.56e31;
const double nofO = 75.28e31;

const string nt[26] = {"$\\mu^{-}$ only & ", "$\\mu^{-}$ p & ", "$\\mu^{-}\\pi^{0}$ & ", "$\\mu^{-}\\pi^{\\pm}$ & ", "$\\mu^{-}$ p $\\pi^{0}$ & ", "$\\mu^{-}$ p $\\pi^{\\pm}$ & ", "$\\mu^{-}\\pi^{0}$ other & ", "$\\mu^{-}$ other & ", "$\\mu^{+}$ only & ", "$\\mu^{+}$ other & ", "$e^{-}$ only & ", "$e^{-}$ p & ", "$e^{-}\\pi^{0}$ & ", "$e^{-}\\pi^{\\pm}$ & ", "$e^{-}$ p $\\pi^{0}$ & ", "$e^{-}$ p $\\pi^{\\pm}$ & ", "$e^{-}\\pi^{0}$ other & ", "$e^{-}$ other & ", "$\\nu$ only & ", "$\\nu$ p & ", "$\\nu\\pi^{0}$ & ", "$\\nu\\pi^{\\pm}$ & ", "$\\nu$ p $\\pi^{0}$ & ", "$\\nu$ p $\\pi^{\\pm}$ & ", "$\\nu\\pi^{0}$ other & ", "$\\nu$ other & "};
const string nt_ex[32] = {"$\\mu^{-}\\pi^{0}\\pi^{\\pm}$", "$\\mu^{-}\\pi^{0}\\pi^{\\pm}p$", "$\\mu^{-}\\pi^{0}2\\pi^{\\pm}$", "$\\mu^{-}\\pi^{0}2\\pi^{\\pm}p$", "$\\mu^{-}\\pi^{0} (>2\\pi^{\\pm})$", "$\\mu^{-}2\\pi^{0}$", "$\\mu^{-}2\\pi^{0}p$", "$\\mu^{-}2\\pi^{\\pm}$", "$\\mu^{-}2\\pi^{\\pm}p$", "$\\mu^{-}2\\pi^{0}\\pi^{\\pm}$", "$\\mu^{-}2\\pi^{0}\\pi^{\\pm}p$", "$\\mu^{-}3\\pi^{0}$", "$\\mu^{-}3\\pi^{0}p$", "$\\mu^{-}3\\pi^{\\pm}$", "$\\mu^{-}3\\pi^{\\pm}p$", "$\\mu^{-}(>3\\pi)$", "$\\nu\\pi^{0}\\pi^{\\pm}$", "$\\nu\\pi^{0}\\pi^{\\pm}p$", "$\\nu\\pi^{0}2\\pi^{\\pm}$", "$\\nu\\pi^{0}2\\pi^{\\pm}p$", "$\\nu\\pi^{0} (>2\\pi^{\\pm})$", "$\\nu2\\pi^{0}$", "$\\nu2\\pi^{0}p$", "$\\nu2\\pi^{\\pm}$", "$\\nu2\\pi^{\\pm}p$", "$\\nu2\\pi^{0}\\pi^{\\pm}$", "$\\nu2\\pi^{0}\\pi^{\\pm}p$", "$\\nu 3\\pi^{0}$", "$\\nu 3\\pi^{0}p$", "$\\nu 3\\pi^{\\pm}$", "$\\nu 3\\pi^{\\pm}p$","$\\nu(>3\\pi)$"};

const double neut[26]  = {43.1, 1.2, 2.1, 6.0, 0.5, 0.9, 0.5, 1.4, 3.1, 1.4, 0.6, 0.09, 0.1, 0.2, 0.09, 0.09, 0.09, 0.1, 22.8, 0.3, 3.7, 2.7, 0.09, 0.09, 0.09, 0.5};
const double genie[27] = {40.6, 1.0, 3.2, 8.7, 0.7, 0.8, 0.3, 0.6, 1.1, 0.8, 0.7, 0.09, 0.1, 0.3, 0.09, 0.09, 0.09, 0.09, 21.1, 0.2, 4.7, 3.4, 0.09, 0.09, 0.09, 0.2};

const double tot_neut = 1530.47;
const double tot_genie = 1397.13;

extern double mom_bin[40];
extern double ang_bin[20];

const string channels[6] = {"pi0pic", "pi0picpr", "2pi0", "2pi0pr", "2pic", "2picpr"};
const string part[4] = {"{/Symbol p}^{0}", "{/Symbol p}^{+/-}", "proton", "null"};
const int top[6][3] = {{0,1,3}, {0,1,2}, {0,0,3}, {0,0,2}, {1,1,3}, {1,1,2}};

const double height[12] = {2.5, 2.5, 0.8, 0.8, 1.4, 1.4, 1.2, 1.2, 0.6, 0.6, 0.7, 0.7};

void tech_sim();
void make_vivi(string filename, double *result, double *extra, bool nucl);
void distribution(string filename, double mom[2][15][41], double ang[2][15][20], bool nucl);
void nu_mix(double in[4][3][27], double ex[4][3][32], double *H, double *Ofg, double * Osf, double *fg, double *sf, double *fgex, double *sfex);
void nu_norm(double *table, double norm, int bins);
void make_table(double *fg, double *sf, double tot_fg, double tot_sf);
void make_table_ex(double *fg, double *sf, double *all_fg, double *all_sf);
void norm_ex(double *tab, double norm, int from, int to);
void make_mom_plot(string filename, string p1, string p2, string p3, int k, bool nc);
void make_ang_plot(string filename, string p1, string p2, string p3, int k, bool nc);
void tech_calc();
#endif
